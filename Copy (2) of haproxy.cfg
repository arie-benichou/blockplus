global
	log 127.0.0.1 local0
    log 127.0.0.1 local1 notice
    user haproxy
    group haproxy    
    maxconn 4096
	nbproc	2
  	daemon
  	
defaults
	mode		http
	
frontend all 0.0.0.0:80
	option nolinger
    timeout client 5000
    default_backend www_backend
    acl is_websocket hdr(Upgrade) -i WebSocket
    acl is_websocket hdr_beg(Host) -i ws
    use_backend socket_backend if is_websocket	

backend www_backend
    option forwardfor
    timeout server 5000
    timeout connect 4000
    server server1 localhost:8080 weight 1 maxconn 1024 check

backend socket_backend
    option forwardfor
    timeout queue 5000
	timeout server 86400000
    timeout connect 86400000    
    server server1 localhost:8080 weight 1 maxconn 1024 check