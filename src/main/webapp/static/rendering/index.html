<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Block+</title>
<script src="/static/js/jquery.min.js"></script>
<style>
.blue {
	background-color: rgb(57, 113, 196);
}

.yellow {
	background-color: rgb(247, 177, 42);
}

.red {
	background-color: rgb(204, 43, 43);
}

.green {
	background-color: rgb(4, 164, 75);
}

.black {
	background-color: #373B3F;
}

.transparent {
	opacity: 0.5
}

table td {
	color: white;
	text-align: center;
	padding: 0;
	width: 26px;
	height: 26px;
	background-color: purple;
}
</style>
</head>
<body>
	<table id="board"></table>
</body>
<script>
	var colors = {
		B : "blue",
		Y : "yellow",
		R : "red",
		G : "green"
	};

	var board = $("#board");
	for ( var i = 0; i < 20; ++i) {
		board.append("<tr></tr>");
		var row = $("#board tr:nth-child(" + (i + 1) + ")");
		for ( var j = 0; j < 20; ++j)
			row.append("<td id='" + (i + ':' + j) + "'></td>");
	}

	var cell = function(row, column) {
		var tr = $("#board tr:nth-child(" + (row + 1) + ")");
		var td = tr.find("td:nth-child(" + (column + 1) + ")");
		return td;
	};

	var reset = function() {
		selection = []
		for ( var i = 0; i < 20; ++i)
			for ( var j = 0; j < 20; ++j)
				cell(i, j).attr('class', "black")
	}

	var parse = function(data) {
		var positions = [];
		var moves = data.split(',');
		for (i in moves) {
			var move = moves[i];
			var color = move.charAt(0)
			var tail = move.substring(1)
			if (tail !== "") {
				var ps = tail.split('-')
				for (j in ps) {
					var position = ps[j].split(':')
					var object = {
						color : colors[color],
						row : parseInt(position[0]),
						column : parseInt(position[1])
					}
					positions.push(object);
				}
			}
		}
		return positions;
	};

	reset();
	var data = window.location.search.substring(1)
	console.log(data)
	var positions = parse(data);
	for (i in positions) {
		var p = positions[i]
		cell(p.row, p.column).attr('class', p.color)
	}
</script>
</html>