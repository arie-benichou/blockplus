<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
</head>
<body>
	<div>
		<div id="board">
			<canvas id="monCanvas" width="100px" height="100px" ></canvas>
		</div>
	</div>
	<script>
		var source = new EventSource('/blockplus/data2');
		source.addEventListener('open', function(event) {
			console.log("Event listening...");
		}, false);
		source.addEventListener('message', function(event) {
			//event.target.close();
			console.log(event.data);
			var canvas = document.getElementById("monCanvas");
			var ctx = canvas.getContext("2d");
			var obj = JSON.parse(event.data);
			for ( var i = 0; i < obj.length; i++) {
				var row = obj[i];
				for ( var j = 0; j < obj.length; j++) {
					console.log(row[j]);
					switch (row[j]) {
					case "Self":
						ctx.fillStyle = "blue";
						break;
					case "Light":
						ctx.fillStyle = "yellow";
						break;
					case "Shadow":
						ctx.fillStyle = "green";
						break;
					case "Other":
						ctx.fillStyle = "red";
						break;
					default:
						ctx.fillStyle = "gray";
					}
					ctx.fillRect(26 * j, 26 * i, 22, 22);
				}
			}
		}, false);
		source.addEventListener('error', function(event) {
			if (event.readyState == EventSource.CLOSED)
				console.log("Event handling error");
		}, false);
	</script>
</body>
</html>