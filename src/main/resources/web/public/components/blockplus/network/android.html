<!DOCTYPE html>
<html>
	<head>
		
        <meta charset="utf-8" />
		
        <link href="../images/favicon.png" rel="shortcut icon" />
        
        <link href="index.css" rel="stylesheet"/>
	<link href="../styles/bootstrap.min.css" rel="stylesheet">
                
        <script src="../scripts/library/jquery.min.js"></script>
        <script src="../scripts/library/bootstrap.min.js"></script>

        <script src="../scripts/modules/Protocol.js"></script>
        <script src="../scripts/modules/Client.js"></script>
        <script src="../scripts/modules/Game.js"></script>
        <script src="../scripts/modules/GameState.js"></script>
        <script src="../scripts/modules/Board.js"></script>
        <script src="../scripts/modules/elements/RemainingPieces.js"></script>
        <script src="../scripts/modules/elements/AvailablePieces.js"></script>
        
        <script src="../scripts/modules/Colors.js"></script>
        <script src="../scripts/modules/Position.js"></script>
        <script src="../scripts/modules/CellRendering.js"></script>
        <script src="../scripts/modules/BoardRendering.js"></script>        
        
        <script src="../scripts/modules/OffsetToPositionBuilder.js"></script>
        <script src="../scripts/modules/SelectedPositions.js"></script>
        <script src="../scripts/modules/PieceImageManager.js"></script>
        <script src="../scripts/modules/Options.js"></script>
        <script src="../scripts/modules/AudioManager.js"></script>
                
        
	</head>
	<body>
    
        <!-- notifications -->
        <div style="height:36px; padding: 12px;">
            <div id="alert" class="alert alert-info fade in" style="display: none; margin:0 auto;">
                <!-- 
                <button type="button" class="close" data-dismiss="alert">×</button>
                 -->
                <p id="notification">loading...</p>
            </div>
        </div>
        
        <!-- connection
        <div id="connection" style="margin:0">
            <h3 id="label">Welcome !</h3>
	    <input type="text" id="user" maxlength="26">
            <button id="connect">Connect</button>
	</div>
	-->

        <!-- games -->
        <div id="games" style="display: none;"></div>
        
        <!-- game -->
        <div id="game" style="display: none;">
            <!--
            <div id="messages">
                <div id="last-message">Loading...</div> 
                <div><button class="btn btn-large btn-primary" id="play-again" type="submit">Play again ?</button></div>
            </div>
            -->
            <div id="content">
                <div id="truc">
                    <div id="left">
                        <div id="available-pieces"></div>
                    </div>
                    <div id="middle">
                        <canvas id="board" width="679px" height="679px"></canvas>
                    </div>
                    <div id="right">
                        <div id="container1">
                            <div id="submitPiece">
                                <canvas class="clickable out" id="pieceToPlay" width="0px" height="0px"></canvas>                        
                            </div>
                        </div>
                        <div style="clear: both;"></div>
                        <div id="chat"></div>
                        <div id="remaining-pieces"></div>
                    </div>      
                      <div style="clear: both;"></div>
                </div>
                <div id="initialization">
                    <canvas id="piece" width="91px" height="91px"></canvas>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">

    		 //$(document).ready(main);

		 var computeLocation = function(suffix) {
	 	 	return document.location.origin.toString().replace('http://', 'ws://').replace('https://', 'wss://') + suffix;
		 };

		var url  = computeLocation("/network/io");

		var connection = function(name) {
		        var object = {
		       		type : 'Client',
			        data : {name : name}
		        };
		        return object;
		};

		Client.message = connection; // TODO à revoir

		var client = new Client("Android", url);
	        client.start(client.join);

		var gameConnection = function(n) {
                	var message = {
                            type : 'GameConnection',
                            data : {ordinal : n}
                        };
                        return message;
		};

                Client.protocol.register("enterGame", function(data) {
                        myGame = new Game(client);
                        myGame.bigMess();
                });

                Client.protocol.register("games", function(data) {
	                client.say(gameConnection(9));
                });

        </script>

	</body>
</html>
